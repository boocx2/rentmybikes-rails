<ul class="nav nav-tabs subledger-nav-tabs">
  <li class="active"><%= link_to "My Balance", account_path %></li>
  <li><%= link_to('My Profile', edit_user_registration_path(current_user)) %></li>
</ul>

<div class="tab-content subledger-tab-content">
  <div class="tab-pane active" id="mybalance">
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Amount</th>
          <th>Balance</th>
        </tr>
      </thead>
      <tbody>
        <% balance = 0 %>
    
        <% @lines.each do |line| %>
          <% if line.value.is_a?(Subledger::Domain::Debit) %>
            <% amount = line.amount * -1 %>
          <% else %>
            <% amount = line.amount %>
          <% end %>
    
          <% balance += amount %>
          <tr>
            <td><%= l line.effective_at, format: :short %></td>
            <td><%= link_to line.description, line.reference, target: "_blank" %></td>
            <td><%= number_to_currency amount %></td>
            <td><%= number_to_currency balance %>
          </tr>
        <% end %>
      </tbody>
      <tfoot>
        <tr>
          <th colspan="2">&nbsp;</th>
          <th>Total</th>
          <th>
            <% if @final_balance.value.is_a?(Subledger::Domain::Debit) %>
              <%= number_to_currency @final_balance.amount * -1 %>
            <% else %>
              <%= number_to_currency @final_balance.amount %>
            <% end %>
          </th>
        </tr>
      </tfoot>
    </table>
  </div>
</div>

